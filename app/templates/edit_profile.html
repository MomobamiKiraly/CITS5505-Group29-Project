<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Edit Profile - F1 Predictor</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/login.css') }}">

</head>

<body>
    <div class="login-container">


        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
        {% for category, message in messages %}
        <div class="alert alert-{{ category }}">
            {{ message }}
        </div>
        {% endfor %}
        {% endif %}
        {% endwith %}

        <form method="POST" enctype="multipart/form-data">
            <h2>Edit Profile</h2>

            <div class="form-group">
                <label class="label" for="username">Username</label>
                <input class="input" type="text" name="username" value="{{ user.username }}" required>
            </div>

            <div class="form-group">
                <label class="label" for="email">Email</label>
                <input class="input" type="email" name="email" value="{{ user.email }}" required>
            </div>

            <!-- Favorite Team dropdown -->
            <div class="form-group">
                <label class="label" for="favorite_team">Favorite Team</label>
                <select name="favorite_team" id="favorite_team" class="input">
                    {% for team in teams %}
                    <option value="{{ team.name }}" {% if user.favorite_team==team.name %}selected{% endif %}>
                        {{ team.name }}
                    </option>
                    {% endfor %}
                </select>
            </div>

            <div class="form-group">
                <label class="label" for="favorite_driver">Favorite Driver</label>
                <select name="favorite_driver" id="favorite_driver" class="input">
                    {% for driver in drivers_by_team[user.favorite_team] %}
                    <option value="{{ driver.name }}" {% if driver.name==user.favorite_driver %}selected{% endif %}>
                        {{ driver.name }}
                    </option>
                    {% endfor %}
                </select>
                </select>
            </div>




            <div class="form-group">
                <label class="label" for="bio">Bio</label>
                <textarea class="input" name="bio">{{ user.bio }}</textarea>
            </div>

            <div class="form-group">
                <label class="label" for="profile_pic">Profile Picture</label>
                <input class="input" type="file" name="profile_pic">
            </div>

            <button type="submit" class="btn">Save Changes</button>
        </form>

    </div>
</body>

</html>

<script>
    const driversByTeam = {{ drivers_by_team | tojson }};
    const selectedTeam = "{{ user.favorite_team }}";
    const selectedDriver = "{{ user.favorite_driver }}";
</script>

<!-- Link to external JS -->
<script src="{{ url_for('static', filename='js/edit_profile.js') }}"></script>
